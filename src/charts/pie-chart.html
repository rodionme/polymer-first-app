<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/d3-bundle-element/d3-element-multi.html">
<link rel="import" href="../../bower_components/multi-chart/chart/multi-chart-simple.html">
<link rel="import" href="../../bower_components/multi-chart/d3-shape/d3-pie.html">
<link rel="import" href="../../bower_components/multi-chart/shape/multi-shape-pie.html">
<link rel="import" href="../../bower_components/multi-chart/multi-selector.html">
<link rel="import" href="../../bower_components/multi-chart/multi-legend.html">
<link rel="stylesheet" href="../../bower_components/multi-chart/multichart.css">

<dom-module id="pie-chart">
  <template>
    <style>
      #chart {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
        -ms-flex-direction: column;
        -webkit-flex-direction: column;
        flex-direction: column;
        -ms-flex-pack: justify;
        -webkit-justify-content: space-between;
        justify-content: space-between;
        height: 400px;
      }

      :host /deep/ [multicontainer].multi-chart-simple {
        -ms-flex: 1 1 auto;
        -webkit-flex: 1 1 auto;
        flex: 1 1 auto;
      }

      :host /deep/ [is-selecting] /deep/ .selectable,
      :host /deep/ [has-selection] /deep/ .selectable {
        fill-opacity: 0.35;
        stroke-opacity: 0.45;
      }

      :host /deep/ [is-selecting] /deep/ .selected,
      :host /deep/ [has-selection] /deep/ .selected {
        fill-opacity: 1;
        stroke-opacity: 1;
      }

      :host /deep/ .selectable {
        cursor: pointer;
      }

      :host /deep/ .selectable:hover {
        stroke-width: 3px;
        stroke-opacity: 0.7;
        fill-opacity: 0.7;
      }
    </style>

    <multi-chart-simple
        id="chart"
        data="[[data]]"
        width="{{width}}"
        height="{{height}}"
        center="{{center}}"
        color-scale="{{colorScale}}"
        key-accessor-path="[[keyAccessorPath]]"
        key-accessor="{{keyAccessor}}"
        value-accessor-path="[[valueAccessorPath]]"
        value-accessor="{{valueAccessor}}">

      <d3-pie data="{{arcs}}"
              value="[[valueAccessor]]"
              pad-angle="[[padAngle]]"
              sort="[[sort]]"
              sort-values="[[sortValues]]"></d3-pie>

      <multi-shape-pie
          width="[[width]]"
          height="[[height]]"
          center="[[center]]"
          arcs="[[arcs]]"
          inner-radius="[[innerRadius]]"
          color-scale="[[colorScale]]"></multi-shape-pie>

      <multi-selector selection-type="select" accessor="[[keyAccessor]]"></multi-selector>

      <multi-legend legend
                    chart-width="[[width]]"
                    scale-factor="0.7"
                    scale="[[colorScale]]"
                    position="top-left"></multi-legend>

    </multi-chart-simple>
  </template>

  <script>
    Polymer({
      is: 'pie-chart',
    });
  </script>
</dom-module>
